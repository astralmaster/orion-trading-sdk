"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("ethers"),n=e(require("bignumber.js")),r=e(require("axios")),a=require("eth-sig-util"),i=e(require("ws")),s=e(require("reconnecting-websocket")),o=e(require("events"));function u(e,t,n,r,a,i,s){try{var o=e[i](s),u=o.value}catch(e){return void n(e)}o.done?t(u):Promise.resolve(u).then(r,a)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function s(e){u(i,r,a,s,o,"next",e)}function o(e){u(i,r,a,s,o,"throw",e)}s(void 0)}))}}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,y(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t,n){return(f=h()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&y(a,n.prototype),a}).apply(null,arguments)}function m(e){var t="function"==typeof Map?new Map:void 0;return(m=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return f(e,arguments,l(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),y(n,e)})(e)}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v,w=(function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=Object.create((t&&t.prototype instanceof d?t:d).prototype),i=new x(r||[]);return a._invoke=function(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return{value:void 0,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var o=T(s,n);if(o){if(o===p)continue;return o}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,i),a}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var p={};function d(){}function l(){}function y(){}var h={};o(h,a,(function(){return this}));var f=Object.getPrototypeOf,m=f&&f(f(A([])));m&&m!==t&&n.call(m,a)&&(h=m);var b=y.prototype=d.prototype=Object.create(h);function v(e){["next","throw","return"].forEach((function(t){o(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){var r;this._invoke=function(a,i){function s(){return new t((function(r,s){!function r(a,i,s,o){var u=c(e[a],e,i);if("throw"!==u.type){var p=u.arg,d=p.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,s,o)}),(function(e){r("throw",e,s,o)})):t.resolve(d).then((function(e){p.value=e,s(p)}),(function(e){return r("throw",e,s,o)}))}o(u.arg)}(a,i,r,s)}))}return r=r?r.then(s,s):s()}}function T(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,p;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function g(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(g,this),this.reset(!0)}function A(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return l.prototype=y,o(b,"constructor",y),o(y,"constructor",l),l.displayName=o(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,o(e,s,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},v(w.prototype),o(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var s=new w(u(t,n,r,a),i);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},v(b),o(b,s,"Generator"),o(b,a,(function(){return this})),o(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=A,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var o=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(o&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;k(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:A(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}(v={exports:{}}),v.exports),T=function(){function e(e){for(var t in this.nameToAddress={},e)e[t]&&(this.nameToAddress[t]=e[t].toLowerCase())}var t=e.prototype;return t.addressToName=function(e){for(var t in this.nameToAddress)if(this.nameToAddress[t]&&this.nameToAddress[t]===e.toLowerCase())return t},t.addressToNameSafe=function(e){var t=this.addressToName(e);if(void 0===t)throw new Error("no token name for "+e);return t},t.nameToAddressSafe=function(e){var t=this.nameToAddress[e];if(!t)throw new Error("no address for "+e);return t},t.addressesToSymbol=function(e,t){var n=this.addressToName(e);if(n){var r=this.addressToName(t);if(r)return n+"-"+r}},t.addressesToSymbolSafe=function(e,t){var n=this.addressesToSymbol(e,t);if(void 0===n)throw new Error("no symbol name for "+e+", "+t);return n},t.symbolToAddresses=function(e){var t=e.split("-");if(2===t.length){var n=this.nameToAddress[t[0]];if(n){var r=this.nameToAddress[t[1]];if(r)return[n,r]}}},e}(),g={__proto__:null,Tokens:T},k={TEST:{BSC:{RPC:"https://data-seed-prebsc-1-s1.binance.org:8545",ORION:"https://testing.orionprotocol.io/bsc-testnet",CHAIN_ID:97,TX_TIMEOUT_SEC:60},ETH:{RPC:"https://testing.orionprotocol.io/eth-ropsten/rpc",ORION:"https://testing.orionprotocol.io/eth-ropsten",CHAIN_ID:3,TX_TIMEOUT_SEC:60}},MAIN:{BSC:{RPC:"https://bsc-dataseed.binance.org",ORION:"https://trade-exp.orionprotocol.io",CHAIN_ID:56,TX_TIMEOUT_SEC:120},ETH:{RPC:"https://trade.orionprotocol.io/rpc",ORION:"https://trade.orionprotocol.io",CHAIN_ID:1,TX_TIMEOUT_SEC:120}}},x={TEST:{BSC:"wss://testing.orionprotocol.io/bsc-testnet",ETH:"wss://testing.orionprotocol.io/eth-ropsten"},MAIN:{BSC:"wss://trade-exp.orionprotocol.io",ETH:"wss://trade.orionprotocol.io"}},A={Order:[{name:"senderAddress",type:"address"},{name:"matcherAddress",type:"address"},{name:"baseAsset",type:"address"},{name:"quoteAsset",type:"address"},{name:"matcherFeeAsset",type:"address"},{name:"amount",type:"uint64"},{name:"price",type:"uint64"},{name:"matcherFee",type:"uint64"},{name:"nonce",type:"uint64"},{name:"expiration",type:"uint64"},{name:"buySide",type:"uint8"}]},O={DeleteOrder:[{name:"sender",type:"address"},{name:"id",type:"string"}]},E=[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"salt",type:"bytes32"}],P={MIN:0,MAX:50},_={approve:{code:1,name:"APPROVE"},deposit:{code:2,name:"DEPOSIT"},withdraw:{code:3,name:"WITHDRAW"}},I={__proto__:null,NETWORK:k,ORION_WS:x,DEFAULT_EXPIRATION:25056e5,ORDER_TYPES:A,CANCEL_ORDER_TYPES_V2:O,CANCEL_ORDER_TYPES:{DeleteOrder:[{name:"senderAddress",type:"address"},{name:"id",type:"uint64"}]},DOMAIN_TYPE:E,ORDER_STATUSES:["NEW","ACCEPTED","DIRECT_SWAP_PENDING","ROUTING","PARTIALLY_FILLED","FILLED","TX_PENDING","REJECTED","SETTLED","CANCELED","FAILED"],NETWORK_TOKEN_ADDRESS:"0x0000000000000000000000000000000000000000",PRICE_DEVIATIONS:P,EXCHANGE_ORDER_PRECISION:8,CHAIN_TX_TYPES:_,TEST_WALLET:{mnemonicPhrase:"announce room limb pattern dry unit scale effort smooth jazz weasel alcohol"}},S=[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function",signature:"0x06fdde03"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],name:"approve",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function",signature:"0x095ea7b3"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function",signature:"0x18160ddd"},{constant:!1,inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function",signature:"0x23b872dd"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"view",type:"function",signature:"0x313ce567"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"addedValue",type:"uint256"}],name:"increaseAllowance",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function",signature:"0x39509351"},{constant:!0,inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function",signature:"0x70a08231"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"view",type:"function",signature:"0x95d89b41"},{constant:!1,inputs:[{name:"spender",type:"address"},{name:"subtractedValue",type:"uint256"}],name:"decreaseAllowance",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function",signature:"0xa457c2d7"},{constant:!1,inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],name:"transfer",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function",signature:"0xa9059cbb"},{constant:!0,inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function",signature:"0xdd62ed3e"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor",signature:"constructor"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event",signature:"0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"},{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event",signature:"0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"}],N=function(e){function t(t,n,r){var a;return(a=e.call(this,r)||this).txHash=t,a.txCode=n.code,a.txName=n.name,a.name="Transaction error",a}return d(t,e),t}(m(Error));function C(e,t,n){var r=n.dividedBy(100),a=("buy"===t?r:r.negated()).plus(1);return e.multipliedBy(a)}function L(e){var r=e.baseAsset,a=e.amount,i=e.networkAsset,s=e.gasPriceWei,o=e.assetsPrices,u=e.feePercent,c=e.feeAsset,p=void 0===c?"ORN":c,d=e.needWithdraw,l=void 0!==d&&d,y=e.isPool,h=void 0!==y&&y,f=e.limits;if(!a||new n(a).isNaN()||new n(a).lte(0))throw new Error("amount field is invalid!");if(!u||Number.isNaN(Number(u))||Number(u)<=0)throw new Error("feePercent field is invalid!");if(!s||new n(s).isNaN()||new n(s).lte("0"))throw new Error("gasPriceWei field is invalid!");if(!o||!Object.entries(o).length)throw new Error("assetsPrices field is invalid!");if(Object.keys(o).forEach((function(e){if(o[e]=new n(o[e]),o[e].isNaN()||o[e].lte(0))throw new Error("assetsPrices."+e+" value should be valid BigNumber")})),!o[r])throw new Error("baseAsset field is invalid!");if(!o[p])throw new Error("feeAsset field is invalid!");if(!o[i])throw new Error("networkAsset field is invalid!");if(!f||!Object.keys(f).length)throw new Error("limits field is required");if(!Object.values(f).every((function(e){return"number"==typeof e&&e>0})))throw new Error("limits values should be positive numbers");var m=function(e){var t=e.baseAsset,r=e.amount,a=e.assetsPrices,i=e.feeAsset,s=new n(e.feePercent).dividedBy(100);return r.multipliedBy(s).multipliedBy(function(e,t,r){return t[e].dividedBy(t[r])||new n(0)}(t,a,i))}({baseAsset:r,amount:a,assetsPrices:o,feePercent:u,feeAsset:p}),b=function(e){var r=e.networkAsset,a=e.feeAsset,i=e.gasPriceWei,s=e.assetsPrices,o=e.needWithdraw,u=e.isPool,c=void 0!==u&&u,p=e.limits;if("N/A"===i)return{networkFeeEth:new n(0),networkFee:new n(0)};["SWAP_THROUGH_ORION_POOL_GAS_LIMIT","FILL_ORDERS_AND_WITHDRAW_GAS_LIMIT","FILL_ORDERS_GAS_LIMIT"].forEach((function(e){if(!Object.keys(p).includes(e))throw new Error(e+" in limits is required!")}));var d=p.SWAP_THROUGH_ORION_POOL_GAS_LIMIT,l=p.FILL_ORDERS_AND_WITHDRAW_GAS_LIMIT,y=p.FILL_ORDERS_GAS_LIMIT,h=new n(t.ethers.utils.formatUnits(i,"ether")).multipliedBy(c?d:o?l:y),f=s[a]&&s[r]?s[r].dividedBy(s[a]):new n(0),m=h.multipliedBy(f);return{networkFeeEth:h,networkFee:m}}({networkAsset:i,feeAsset:p,gasPriceWei:s,assetsPrices:o,needWithdraw:l,isPool:h,limits:f}).networkFee;if(!m.gt(0))throw new Error("matcherFee couldn`t be 0!");if(!b.gt(0))throw new Error("networkFee couldn`t be 0!");return m.plus(b).decimalPlaces(8)}function M(e){return{pair:e.symbol,exchange:e.exchange,id:Number(e.id),amount:new n(e.subOrdQty),price:new n(e.price),status:e.status||"NEW",side:e.side,sent:e.sent}}function R(e){var t=new n(e.amount),r=new n(e.price),a=e.assetPair.split("-"),i=a[0],s=a[1],o=Object.keys(e.subOrders),u=o.length?o.map((function(t){return B(e.subOrders[t])})):[],c=t.multipliedBy(r);return p({},{date:Number(e.creationTime),sender:e.sender,id:e.id,type:e.side,pair:e.assetPair},{blockchainOrder:null==e?void 0:e.blockchainOrder,status:e.status,baseAsset:i,quoteAsset:s,feeAsset:e.feeAsset,fee:new n(e.fee),amount:t,side:e.side,price:r,total:c,subOrders:u})}function B(e){return{pair:e.assetPair,exchange:e.exchange,id:Number(e.id),amount:new n(e.amount),price:new n(e.price),status:e.status||"NEW",side:e.side,tradesInfo:e.tradesInfo}}function D(e){var t,r=new n(e[0]),a=new n(e[1]);return{price:r,size:a,total:r.multipliedBy(a),cumulativeSize:new n(0),cumulativeTotal:new n(0),avgPrice:new n(0),deltaSize:0,exchanges:null==(t=e[2])?void 0:t.map((function(e){return e.toLowerCase()}))}}function F(e){var t=e.ob,n=t.b;return{asks:t.a.map(D),bids:n.map(D)}}function j(e){var t=e[0],r=t.split("-"),a=r[0],i=r[1],s=new n(e[1]),o=new n(e[2]),u=s.div(o).minus(1).multipliedBy(100);return{name:t,fromCurrency:a,toCurrency:i,lastPrice:s,openPrice:o,change24h:u,high:new n(e[3]),low:new n(e[4]),vol24h:new n(e[5])}}function W(e){for(var t={},n=1;n<e.length;n++){var r=j(e[n]);t[r.name]=r}return t}function U(e,r,a){if(e===a.baseCurrencyName)return t.ethers.utils.parseEther(r.toString()).toString();var i=a.assetToDecimals[e];if(void 0===i)throw new Error("no decimals for "+e);return r.multipliedBy(Math.pow(10,i)).toFixed(0,n.ROUND_DOWN)}function G(e,t,n){var r=e===n.baseCurrencyName?18:n.assetToDecimals[e];if(void 0===r)throw new Error("no decimals for "+e);return t.dividedBy(Math.pow(10,r))}function q(e){return Number(new n(e).multipliedBy(1e8).toFixed(0))}function H(e){return V.apply(this,arguments)}function V(){return(V=c(w.mark((function e(t){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return e.abrupt("return",e.sent.data);case 8:return e.prev=8,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function X(e,t,n){return Y.apply(this,arguments)}function Y(){return(Y=c(w.mark((function e(t,n,r){var a,i,s;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!1,i=setTimeout((function(){if(!a)throw new N(t.hash,r,"Request failed due to exceeding the time limit of "+n+" seconds!")}),1e3*n),e.next=4,t.wait();case 4:if(s=e.sent,a=!0,clearTimeout(i),1===s.status){e.next=9;break}throw new N(t.hash,r,"Request failed with status "+s.status+"!");case 9:return e.abrupt("return",t.hash);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e){var n={},r=e.blockchainInfo.assetToAddress;for(var a in r)if(a!==e.blockchainInfo.baseCurrencyName){var i=r[a],s=new t.ethers.Contract(i,S,e.signer);n[a]=s,n[i]=s}return n}var z={__proto__:null,getPriceWithDeviation:C,sumBigNumber:function(e){for(var t,r=new n(0),a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return b(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(t=a()).done;)r=r.plus(t.value);return r},getFee:L,parseTradeOrder:function(e){var t=new n(e.orderQty),r=new n(e.price),a=e.subOrders?e.subOrders.map((function(e){return M(e)})):[],i=t.multipliedBy(r);return p({},{date:Number(e.time),sender:e.clientId,id:Number(e.id),type:e.side,pair:e.symbol},{blockchainOrder:null==e?void 0:e.blockchainOrder,status:e.status,baseAsset:e.baseAsset,quoteAsset:e.quoteAsset,feeAsset:e.feeCurrency,fee:new n(e.feeQty),side:e.side,amount:t,price:r,total:i,subOrders:a})},parseTradeSubOrder:M,parseTradeOrderV2:R,parseTradeSubOrderV2:B,canCancelOrder:function(e){return"NEW"===e.status||"ACCEPTED"===e.status||"ROUTING"===e.status||"PARTIALLY_FILLED"===e.status},isOrderOpen:function(e){return"NEW"===e.status||"ACCEPTED"===e.status||"ROUTING"===e.status||"PARTIALLY_FILLED"===e.status||"FILLED"===e.status||"TX_PENDING"===e.status||"DIRECT_SWAP_PENDING"===e.status},parseOrderbookItem:D,parseOrderbookItemsV1:function(e){var t=e.bids;return{asks:e.asks.map(D),bids:t.map(D)}},parseOrderbookItemsV2:F,parsePair:j,parsePairs:W,numberToUnit:U,unitToNumber:G,numberTo8:q,handleResponse:H,waitForTx:X,getTokenContracts:K},Q=function e(t){if(e.instance)return e.instance;e.instance=this,this.orionBlockchain=r.create({baseURL:t.ORION+"/api",timeout:5e3}),this.orionAggregator=r.create({baseURL:t.ORION+"/backend/api/v1",timeout:5e3}),this.binance=r.create({baseURL:t.RPC,timeout:5e3})},Z=function(){function e(e,n){void 0===n&&(n=k.TEST.BSC),this.provider=new t.ethers.providers.JsonRpcProvider(n.RPC),this.api=new Q(n);var r=e.startsWith("0x")?e:"0x"+e;this.signer=new t.ethers.Wallet(r).connect(this.provider),this.network=n}var r,a=e.prototype;return a.init=function(){var e=c(w.mark((function e(){var t;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBlockchainInfo();case 2:return t=e.sent,e.next=5,this.getTokensFee();case 5:return this._tokensFee=e.sent,e.next=8,this.getBaseLimits();case 8:this._baseLimits=e.sent,t.baseCurrencyName=this.getNetworkAsset(t),this._blockchainInfo=t,this._tokens=new T(this._blockchainInfo.assetToAddress),this._isEthereum="ETH"===this._blockchainInfo.baseCurrencyName,this.tokensContracts=K(this);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.getTokenAddress=function(e){return this.blockchainInfo.assetToAddress[e]},a.getTokenSymbolsList=function(){return Object.keys(this.blockchainInfo.assetToAddress)},a.getTokenAddressesList=function(){return Object.values(this.blockchainInfo.assetToAddress)},a.tokenAddressToName=function(e){for(var t in this.blockchainInfo.assetToAddress)if(Object.prototype.hasOwnProperty.call(this.blockchainInfo.assetToAddress,t)&&this.blockchainInfo.assetToAddress[t]===e.toLowerCase())return t;return""},a.getNetworkAsset=function(e){var t=Object.entries(e.assetToAddress).find((function(e){return"0x0000000000000000000000000000000000000000"===e[1]}));if(!t||!t[0])throw new Error("Cannot get network token!");return t[0]},a.isNetworkAsset=function(e){return this.blockchainInfo.baseCurrencyName.toUpperCase()===e.toUpperCase()},a.checkNetworkTokens=function(){var e=c(w.mark((function e(){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getNetworkBalance();case 2:if(e.sent.gt(0)){e.next=5;break}throw new Error("A non-zero balance of network tokens is required!");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.getBlockchainInfo=function(){return H(this.api.orionBlockchain.get("/info"))},a.getTokensFee=function(){return H(this.api.orionBlockchain.get("/tokensFee"))},a.getBaseLimits=function(){return H(this.api.orionBlockchain.get("/baseLimits"))},a.getBlockchainPrices=function(){var e=c(w.mark((function e(){var t,r,a,i;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H(this.api.orionBlockchain.get("/prices"));case 3:for(a in r={},t=e.sent)(i=this.tokens.addressToName(a))&&(r[i]=new n(t[a]));return e.abrupt("return",r);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),a.getGasPrice=function(){var e=c(w.mark((function e(){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isEthereum){e.next=2;break}return e.abrupt("return",this.getGasPriceOB());case 2:return e.abrupt("return",this.getGasPriceBinance());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.getGasPriceOB=function(){var e=c(w.mark((function e(){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",H(this.api.orionBlockchain.get("/gasPrice")));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),a.getGasPriceBinance=function(){var e=c(w.mark((function e(){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H(this.api.binance.post("",{jsonrpc:"2.0",id:1,method:"eth_gasPrice",params:[]}));case 3:return e.abrupt("return",new n(e.sent.result).toString());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),a.getNetworkBalance=function(){var e=c(w.mark((function e(){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.provider.getBalance(this.signer.address);case 3:return e.abrupt("return",new n(t.ethers.utils.formatEther(e.sent)));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),a.getWalletBalance=function(){var e=c(w.mark((function e(t){var n=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){if(t===n.blockchainInfo.baseCurrencyName)n.getNetworkBalance().then((function(t){var r;e(((r={})[n.blockchainInfo.baseCurrencyName]=t.toString(),r))})).catch((function(e){return r(e)}));else{var a=[];try{var i=n.getTokenSymbolsList();t&&(i=i.filter((function(e){return e===t.toUpperCase()}))),i.forEach((function(e){e!==n.blockchainInfo.baseCurrencyName&&a.push(n.getTokenBalance(e))})),Promise.all(a).then((function(t){var n={};t.forEach((function(e){var t=e[0].toString(),r=e[1].toString();n[t]=r})),e(n)}))}catch(e){r(e)}}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getTokenBalance=function(){var e=c(w.mark((function e(t){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.tokensContracts[t].balanceOf(this.signer.address);case 3:return e.abrupt("return",[t,e.sent.toString()]);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),a.sendTransaction=function(){var e=c(w.mark((function e(n,r,a){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r>0&&(n.gasLimit=t.ethers.BigNumber.from(r)),n.gasPrice=t.ethers.BigNumber.from(a.toString()),e.next=5,this.signer.populateTransaction(n);case 5:return e.abrupt("return",this.signer.sendTransaction(e.sent));case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t,n,r){return e.apply(this,arguments)}}(),a.getAllowance=function(){var e=c(w.mark((function e(t,r){var a,i;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,i=this.tokensContracts[t],(a=this.blockchainInfo.assetToDecimals[t])&&i){e.next=5;break}throw new Error("Currency is invaild!");case 5:return r||(r=this.blockchainInfo.exchangeContractAddress),e.next=8,i.allowance(this.signer.address,r);case 8:return e.abrupt("return",new n(e.sent.toString()).dividedBy(Math.pow(10,a)));case 12:return e.prev=12,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(t,n){return e.apply(this,arguments)}}(),a.allowanceHandler=function(){var e=c(w.mark((function e(r,a,i){var s,o;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isNetworkAsset(r)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,s=new n(a),o=this.tokensContracts[r],e.next=7,this.getAllowance(r);case 7:if(!e.sent.lt(s)){e.next=19;break}return e.next=11,this.checkNeedZeroReset(o);case 11:if(!e.sent){e.next=18;break}return e.next=15,this.approve(r,t.ethers.constants.Zero.toString(),i);case 15:case 18:return e.abrupt("return",this.approve(r,t.ethers.constants.MaxUint256.toString(),i));case 19:e.next=24;break;case 21:return e.prev=21,e.t0=e.catch(2),e.abrupt("return",Promise.reject(e.t0));case 24:case"end":return e.stop()}}),e,this,[[2,21]])})));return function(t,n,r){return e.apply(this,arguments)}}(),a.checkNeedZeroReset=function(){var e=c(w.mark((function e(n){var r;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.populateTransaction.approve(this.signer.address,t.ethers.constants.MaxUint256);case 2:return r=e.sent,e.prev=3,e.next=6,this.signer.estimateGas(r);case 6:return e.abrupt("return",!1);case 9:return e.prev=9,e.t0=e.catch(3),e.abrupt("return",!0);case 12:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),a.approve=function(){var e=c(w.mark((function e(t,n,r){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.checkNetworkTokens();case 3:if(!r){e.next=7;break}e.t0=r,e.next=10;break;case 7:return e.next=9,this.getGasPrice();case 9:e.t0=e.sent;case 10:return e.abrupt("return",this.approveERC20({amountUnit:n,gasPriceWei:e.t0,toAddress:this.blockchainInfo.exchangeContractAddress,tokenContract:this.tokensContracts[t]}));case 16:return e.prev=16,e.t1=e.catch(0),e.abrupt("return",Promise.reject(e.t1));case 19:case"end":return e.stop()}}),e,this,[[0,16]])})));return function(t,n,r){return e.apply(this,arguments)}}(),a.approveERC20=function(){var e=c(w.mark((function e(t){var r,a,i,s,o;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.amountUnit,a=t.gasPriceWei,i=t.toAddress,s=t.tokenContract,e.prev=1,e.next=4,s.populateTransaction.approve(i,r);case 4:return o=e.sent,e.next=7,this.sendTransaction(o,this.baseLimits.APPROVE_ERC20_GAS_LIMIT,new n(a));case 7:return e.abrupt("return",X(e.sent,this.network.TX_TIMEOUT_SEC,_.approve));case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",Promise.reject(e.t0));case 14:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),(r=[{key:"blockchainInfo",get:function(){return this._blockchainInfo}},{key:"tokens",get:function(){return this._tokens}},{key:"baseLimits",get:function(){return this._baseLimits}},{key:"tokensFee",get:function(){return this._tokensFee}},{key:"isEthereum",get:function(){return this._isEthereum}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,r),e}(),J=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!0,internalType:"address",name:"assetAddress",type:"address"},{indexed:!1,internalType:"bool",name:"isDeposit",type:"bool"},{indexed:!1,internalType:"uint112",name:"amount",type:"uint112"},{indexed:!1,internalType:"uint64",name:"timestamp",type:"uint64"}],name:"NewAssetTransaction",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"address",name:"asset_spend",type:"address"},{indexed:!1,internalType:"address",name:"asset_receive",type:"address"},{indexed:!1,internalType:"int112",name:"amount_spent",type:"int112"},{indexed:!1,internalType:"int112",name:"amount_received",type:"int112"}],name:"NewSwapOrionPool",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"buyer",type:"address"},{indexed:!0,internalType:"address",name:"seller",type:"address"},{indexed:!1,internalType:"address",name:"baseAsset",type:"address"},{indexed:!1,internalType:"address",name:"quoteAsset",type:"address"},{indexed:!1,internalType:"uint64",name:"filledPrice",type:"uint64"},{indexed:!1,internalType:"uint192",name:"filledAmount",type:"uint192"},{indexed:!1,internalType:"uint192",name:"amountQuote",type:"uint192"}],name:"NewTrade",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{stateMutability:"nonpayable",type:"fallback"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"allowStakeRelease",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"assetRisks",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"calcPosition",outputs:[{components:[{internalType:"enum MarginalFunctionality.PositionState",name:"state",type:"uint8"},{internalType:"int256",name:"weightedPosition",type:"int256"},{internalType:"int256",name:"totalPosition",type:"int256"},{internalType:"int256",name:"totalLiabilities",type:"int256"}],internalType:"struct MarginalFunctionality.Position",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"checkPosition",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"deposit",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"assetAddress",type:"address"},{internalType:"uint112",name:"amount",type:"uint112"}],name:"depositAsset",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address",name:"senderAddress",type:"address"},{internalType:"address",name:"matcherAddress",type:"address"},{internalType:"address",name:"baseAsset",type:"address"},{internalType:"address",name:"quoteAsset",type:"address"},{internalType:"address",name:"matcherFeeAsset",type:"address"},{internalType:"uint64",name:"amount",type:"uint64"},{internalType:"uint64",name:"price",type:"uint64"},{internalType:"uint64",name:"matcherFee",type:"uint64"},{internalType:"uint64",name:"nonce",type:"uint64"},{internalType:"uint64",name:"expiration",type:"uint64"},{internalType:"uint8",name:"buySide",type:"uint8"},{internalType:"bool",name:"isPersonalSign",type:"bool"},{internalType:"bytes",name:"signature",type:"bytes"}],internalType:"struct LibValidator.Order",name:"buyOrder",type:"tuple"},{components:[{internalType:"address",name:"senderAddress",type:"address"},{internalType:"address",name:"matcherAddress",type:"address"},{internalType:"address",name:"baseAsset",type:"address"},{internalType:"address",name:"quoteAsset",type:"address"},{internalType:"address",name:"matcherFeeAsset",type:"address"},{internalType:"uint64",name:"amount",type:"uint64"},{internalType:"uint64",name:"price",type:"uint64"},{internalType:"uint64",name:"matcherFee",type:"uint64"},{internalType:"uint64",name:"nonce",type:"uint64"},{internalType:"uint64",name:"expiration",type:"uint64"},{internalType:"uint8",name:"buySide",type:"uint8"},{internalType:"bool",name:"isPersonalSign",type:"bool"},{internalType:"bytes",name:"signature",type:"bytes"}],internalType:"struct LibValidator.Order",name:"sellOrder",type:"tuple"},{internalType:"uint64",name:"filledPrice",type:"uint64"},{internalType:"uint112",name:"filledAmount",type:"uint112"}],name:"fillOrders",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address",name:"senderAddress",type:"address"},{internalType:"address",name:"matcherAddress",type:"address"},{internalType:"address",name:"baseAsset",type:"address"},{internalType:"address",name:"quoteAsset",type:"address"},{internalType:"address",name:"matcherFeeAsset",type:"address"},{internalType:"uint64",name:"amount",type:"uint64"},{internalType:"uint64",name:"price",type:"uint64"},{internalType:"uint64",name:"matcherFee",type:"uint64"},{internalType:"uint64",name:"nonce",type:"uint64"},{internalType:"uint64",name:"expiration",type:"uint64"},{internalType:"uint8",name:"buySide",type:"uint8"},{internalType:"bool",name:"isPersonalSign",type:"bool"},{internalType:"bytes",name:"signature",type:"bytes"}],internalType:"struct LibValidator.Order",name:"order",type:"tuple"},{internalType:"uint112",name:"filledAmount",type:"uint112"},{internalType:"uint64",name:"blockchainFee",type:"uint64"},{internalType:"address[]",name:"path",type:"address[]"}],name:"fillThroughOrionPool",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"filledAmounts",outputs:[{internalType:"uint192",name:"",type:"uint192"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"assetAddress",type:"address"},{internalType:"address",name:"user",type:"address"}],name:"getBalance",outputs:[{internalType:"int192",name:"",type:"int192"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"assetsAddresses",type:"address[]"},{internalType:"address",name:"user",type:"address"}],name:"getBalances",outputs:[{internalType:"int192[]",name:"balances",type:"int192[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCollateralAssets",outputs:[{internalType:"address[]",name:"",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"},{components:[{internalType:"address",name:"senderAddress",type:"address"},{internalType:"address",name:"matcherAddress",type:"address"},{internalType:"address",name:"baseAsset",type:"address"},{internalType:"address",name:"quoteAsset",type:"address"},{internalType:"address",name:"matcherFeeAsset",type:"address"},{internalType:"uint64",name:"amount",type:"uint64"},{internalType:"uint64",name:"price",type:"uint64"},{internalType:"uint64",name:"matcherFee",type:"uint64"},{internalType:"uint64",name:"nonce",type:"uint64"},{internalType:"uint64",name:"expiration",type:"uint64"},{internalType:"uint8",name:"buySide",type:"uint8"},{internalType:"bool",name:"isPersonalSign",type:"bool"},{internalType:"bytes",name:"signature",type:"bytes"}],internalType:"struct LibValidator.Order",name:"order",type:"tuple"}],name:"getFilledAmounts",outputs:[{internalType:"int192",name:"totalFilled",type:"int192"},{internalType:"int192",name:"totalFeesPaid",type:"int192"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getLiabilities",outputs:[{components:[{internalType:"address",name:"asset",type:"address"},{internalType:"uint64",name:"timestamp",type:"uint64"},{internalType:"uint192",name:"outstandingAmount",type:"uint192"}],internalType:"struct MarginalFunctionality.Liability[]",name:"liabilitiesArray",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getLockedStakeBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address",name:"senderAddress",type:"address"},{internalType:"address",name:"matcherAddress",type:"address"},{internalType:"address",name:"baseAsset",type:"address"},{internalType:"address",name:"quoteAsset",type:"address"},{internalType:"address",name:"matcherFeeAsset",type:"address"},{internalType:"uint64",name:"amount",type:"uint64"},{internalType:"uint64",name:"price",type:"uint64"},{internalType:"uint64",name:"matcherFee",type:"uint64"},{internalType:"uint64",name:"nonce",type:"uint64"},{internalType:"uint64",name:"expiration",type:"uint64"},{internalType:"uint8",name:"buySide",type:"uint8"},{internalType:"bool",name:"isPersonalSign",type:"bool"},{internalType:"bytes",name:"signature",type:"bytes"}],internalType:"struct LibValidator.Order",name:"order",type:"tuple"}],name:"getOrderHash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getStake",outputs:[{components:[{internalType:"uint64",name:"amount",type:"uint64"},{internalType:"enum OrionVault.StakePhase",name:"phase",type:"uint8"},{internalType:"uint64",name:"lastActionTimestamp",type:"uint64"}],internalType:"struct OrionVault.Stake",name:"stake",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getStakeBalance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"getStakePhase",outputs:[{internalType:"enum OrionVault.StakePhase",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[],name:"initialize",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"}],name:"liabilities",outputs:[{internalType:"address",name:"asset",type:"address"},{internalType:"uint64",name:"timestamp",type:"uint64"},{internalType:"uint192",name:"outstandingAmount",type:"uint192"}],stateMutability:"view",type:"function"},{inputs:[],name:"liquidationPremium",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint64",name:"amount",type:"uint64"}],name:"lockStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"broker",type:"address"},{internalType:"address",name:"redeemedAsset",type:"address"},{internalType:"uint112",name:"amount",type:"uint112"}],name:"partiallyLiquidate",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"positionOverdue",outputs:[{internalType:"uint64",name:"",type:"uint64"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"}],name:"postponeStakeRelease",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"priceOverdue",outputs:[{internalType:"uint64",name:"",type:"uint64"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"requestReleaseStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"receiver",type:"address"},{internalType:"uint64",name:"amount",type:"uint64"}],name:"seizeFromStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"orionToken",type:"address"},{internalType:"address",name:"priceOracleAddress",type:"address"},{internalType:"address",name:"allowedMatcher",type:"address"}],name:"setBasicParams",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"orionToken",type:"address"},{internalType:"address",name:"priceOracleAddress",type:"address"},{internalType:"address",name:"allowedMatcher",type:"address"},{internalType:"address",name:"orionpoolRouter",type:"address"}],name:"setBasicParams",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"stakeRisk",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint112",name:"amount_spend",type:"uint112"},{internalType:"uint112",name:"amount_receive",type:"uint112"},{internalType:"address[]",name:"path",type:"address[]"},{internalType:"bool",name:"is_exact_spend",type:"bool"}],name:"swapThroughOrionPool",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"assets",type:"address[]"},{internalType:"uint8[]",name:"risks",type:"uint8[]"}],name:"updateAssetRisks",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"_collateralAssets",type:"address[]"},{internalType:"uint8",name:"_stakeRisk",type:"uint8"},{internalType:"uint8",name:"_liquidationPremium",type:"uint8"},{internalType:"uint64",name:"_priceOverdue",type:"uint64"},{internalType:"uint64",name:"_positionOverdue",type:"uint64"}],name:"updateMarginalSettings",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address",name:"senderAddress",type:"address"},{internalType:"address",name:"matcherAddress",type:"address"},{internalType:"address",name:"baseAsset",type:"address"},{internalType:"address",name:"quoteAsset",type:"address"},{internalType:"address",name:"matcherFeeAsset",type:"address"},{internalType:"uint64",name:"amount",type:"uint64"},{internalType:"uint64",name:"price",type:"uint64"},{internalType:"uint64",name:"matcherFee",type:"uint64"},{internalType:"uint64",name:"nonce",type:"uint64"},{internalType:"uint64",name:"expiration",type:"uint64"},{internalType:"uint8",name:"buySide",type:"uint8"},{internalType:"bool",name:"isPersonalSign",type:"bool"},{internalType:"bytes",name:"signature",type:"bytes"}],internalType:"struct LibValidator.Order",name:"order",type:"tuple"}],name:"validateOrder",outputs:[{internalType:"bool",name:"isValid",type:"bool"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"assetAddress",type:"address"},{internalType:"uint112",name:"amount",type:"uint112"}],name:"withdraw",outputs:[],stateMutability:"nonpayable",type:"function"}],$=function(){function e(e){this.chain=e,this.exchangeContract=new t.ethers.Contract(this.chain.blockchainInfo.exchangeContractAddress,J,this.chain.signer)}var r=e.prototype;return r.getContractBalance=function(){var e=c(w.mark((function e(t){var n,r,a,i,s,o,u=this;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t?t.toUpperCase():"",e.prev=1,!n||this.chain.getTokenSymbolsList().includes(n)){e.next=4;break}throw new Error("Invalid token");case 4:return r={},a=n?[this.chain.getTokenAddress(n)]:this.chain.getTokenAddressesList(),i=n?[n]:this.chain.getTokenSymbolsList(),e.next=9,this.exchangeContract.getBalances(a,this.chain.signer.address);case 9:return s=e.sent,e.next=12,this.checkReservedBalance(this.chain.signer.address);case 12:return o=e.sent,s.forEach((function(e,t){r[i[t]]=u.parseContractBalance(e,o[i[t]]||0)})),e.abrupt("return",r);case 17:return e.prev=17,e.t0=e.catch(1),e.abrupt("return",Promise.reject(e.t0));case 20:case"end":return e.stop()}}),e,this,[[1,17]])})));return function(t){return e.apply(this,arguments)}}(),r.checkReservedBalance=function(){var e=c(w.mark((function e(t,n){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=""),e.abrupt("return",H(this.chain.api.orionAggregator.get("/address/balance/reserved/"+n+"?address="+t)));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r.parseContractBalance=function(e,r){var a=t.ethers.utils.formatUnits(t.ethers.BigNumber.from(e.toString()),8),i=new n(a),s=new n(r),o=i.minus(s);return{total:i,locked:s,available:o}},r.depositETH=function(){var e=c(w.mark((function e(n,r){var a;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.exchangeContract.populateTransaction.deposit();case 2:return(a=e.sent).value=t.ethers.BigNumber.from(n),e.next=6,this.chain.sendTransaction(a,this.chain.baseLimits.DEPOSIT_ETH_GAS_LIMIT,r);case 6:return e.abrupt("return",X(e.sent,this.chain.network.TX_TIMEOUT_SEC,_.deposit));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),r.depositERC20=function(){var e=c(w.mark((function e(t,n,r){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this.chain,e.next=3,this.exchangeContract.populateTransaction.depositAsset(this.chain.getTokenAddress(t),n);case 3:return e.t1=e.sent,e.t2=this.chain.baseLimits.DEPOSIT_ERC20_GAS_LIMIT,e.t3=r,e.next=8,e.t0.sendTransaction.call(e.t0,e.t1,e.t2,e.t3);case 8:return e.abrupt("return",X(e.sent,this.chain.network.TX_TIMEOUT_SEC,_.deposit));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}(),r.deposit=function(){var e=c(w.mark((function e(t,r,a){var i,s,o,u;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.chain.checkNetworkTokens();case 3:return i=new n(r),s=U(t,i,this.chain.blockchainInfo),e.next=7,this.chain.getWalletBalance(t);case 7:if(!(o=G(t,new n(e.sent[t]),this.chain.blockchainInfo)).lt(i)){e.next=11;break}throw new Error("The wallet balance ("+o+") is lower than the deposit amount ("+r+")!");case 11:if(!a){e.next=15;break}e.t0=a,e.next=18;break;case 15:return e.next=17,this.chain.getGasPrice();case 17:e.t0=e.sent;case 18:if(u=e.t0,!this.chain.isNetworkAsset(t)){e.next=23;break}return e.abrupt("return",this.depositETH(s,new n(u)));case 23:return e.next=25,this.chain.allowanceHandler(t,r,u);case 25:return e.abrupt("return",this.depositERC20(t,s,new n(u)));case 26:e.next=31;break;case 28:return e.prev=28,e.t1=e.catch(0),e.abrupt("return",Promise.reject(e.t1));case 31:case"end":return e.stop()}}),e,this,[[0,28]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.withdraw=function(){var e=c(w.mark((function e(t,r,a){var i,s,o;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.chain.checkNetworkTokens();case 3:return i=U(t,new n(r),this.chain.blockchainInfo),e.next=6,this.getContractBalance(t);case 6:if(s=e.sent,!a){e.next=11;break}e.t0=a,e.next=14;break;case 11:return e.next=13,this.chain.getGasPrice();case 13:e.t0=e.sent;case 14:if(o=e.t0,!s[t].available.lt(new n(r))){e.next=17;break}throw new Error("The available contract balance ("+s[t].available+") is less than the withdrawal amount ("+new n(r)+")! ");case 17:return e.t1=this.chain,e.next=20,this.exchangeContract.populateTransaction.withdraw(this.chain.getTokenAddress(t),i);case 20:return e.t2=e.sent,e.t3=this.chain.baseLimits.WITHDRAW_GAS_LIMIT,e.t4=new n(o),e.next=25,e.t1.sendTransaction.call(e.t1,e.t2,e.t3,e.t4);case 25:return e.abrupt("return",X(e.sent,this.chain.network.TX_TIMEOUT_SEC,_.withdraw));case 29:return e.prev=29,e.t5=e.catch(0),e.abrupt("return",Promise.reject(e.t5));case 32:case"end":return e.stop()}}),e,this,[[0,29]])})));return function(t,n,r){return e.apply(this,arguments)}}(),r.validateOrder=function(){var e=c(w.mark((function e(t){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.exchangeContract.validateOrder(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),e}();function ee(e){return{name:"Orion Exchange",version:"1",chainId:e,salt:"0xf2d857f4a3edcb9b78b4d503bfe733db1e3f6cdc2b7971ee739626c97e86a557"}}function te(e,t,n){return ne.apply(this,arguments)}function ne(){return(ne=c(w.mark((function e(t,n,r){var i,s,o;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.privateKey){e.next=7;break}return i={types:{EIP712Domain:E,DeleteOrder:O.DeleteOrder},domain:ee(r),primaryType:"DeleteOrder",message:t},s={data:i},o=Buffer.from(n.privateKey.substr(2),"hex"),e.abrupt("return",a.signTypedMessage(o,s,"V4"));case 7:throw new Error("privateKey is required!");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e,t,n){return ae.apply(this,arguments)}function ae(){return(ae=c(w.mark((function e(t,n,r){var i,s,o;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.privateKey){e.next=7;break}return i={types:{EIP712Domain:E,Order:A.Order},domain:ee(r),primaryType:"Order",message:t},s={data:i},o=Buffer.from(n.privateKey.substr(2),"hex"),e.abrupt("return",a.signTypedMessage(o,s,"V4"));case 7:throw new Error("privateKey is required!");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e){return t.ethers.utils.solidityKeccak256(["uint8","address","address","address","address","address","uint64","uint64","uint64","uint64","uint64","uint8"],["0x03",e.senderAddress,e.matcherAddress,e.baseAsset,e.quoteAsset,e.matcherFeeAsset,e.amount,e.price,e.matcherFee,e.nonce,e.expiration,e.buySide?"0x01":"0x00"])}var se,oe=function(){function e(e){this.chain=e,this.exchange=new $(e)}var t=e.prototype;return t.init=function(){var e=c(w.mark((function e(){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("OrionAggregator.init() method is currently deprecated and unnecessary"),e.abrupt("return",new Promise((function(e){return e(!0)})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.getPairsInfo=function(){var e=c(w.mark((function e(){var t;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,H(this.chain.api.orionAggregator.get("/pairs/exchangeInfo"));case 3:return t={},e.sent.forEach((function(e){t[e.name]=e})),e.abrupt("return",t);case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),t.checkBalanceForOrder=function(){var e=c(w.mark((function e(t,n,r){var a,i,s;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a="buy"===t.side?t.toCurrency.toUpperCase():t.fromCurrency.toUpperCase(),i="buy"===t.side?t.amount.multipliedBy(t.price):t.amount,e.next=5,this.exchange.getContractBalance();case 5:if(s=e.sent,a!==n){e.next=11;break}if(!s[a].available.lt(i.plus(r))){e.next=9;break}throw new Error("The available contract balance ("+s[a].available+" "+a+") is less than the order amount+fee ("+i.plus(r)+" "+a+")!");case 9:e.next=15;break;case 11:if(!s[a].available.lt(i)){e.next=13;break}throw new Error("The available contract balance ("+s[a].available+" "+a+") is less than the order amount ("+i+" "+a+")!");case 13:if(!s[n].available.lt(r)){e.next=15;break}throw new Error("The available contract balance ("+s[n].available+" "+n+") is less than the order fee amount ("+r+" "+n+")!");case 15:e.next=20;break;case 17:return e.prev=17,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 20:case"end":return e.stop()}}),e,this,[[0,17]])})));return function(t,n,r){return e.apply(this,arguments)}}(),t.formatRawOrder=function(){var e=c(w.mark((function e(t){var r,a,i;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.fromCurrency.toUpperCase()+"-"+t.toCurrency.toUpperCase(),e.next=3,this.getPairsInfo();case 3:if(a=e.sent[r]){e.next=7;break}throw new Error("No such pair "+r);case 7:if(!t.priceDeviation||!new n(P.MIN).gt(t.priceDeviation)&&!new n(P.MAX).lt(t.priceDeviation)){e.next=9;break}throw new Error("priceDeviation value should between "+P.MIN+" and "+P.MAX);case 9:return i=Object.assign(t,{numberFormat:a,price:new n(t.price),amount:new n(t.amount),priceDeviation:new n(void 0!==t.priceDeviation?t.priceDeviation:0),needWithdraw:t.needWithdraw||!1}),e.abrupt("return",i);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.createOrder=function(){var e=c(w.mark((function e(t){var r,a,i,s,o,u,c,p,d,l,y,h,f;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.formatRawOrder(t);case 3:if(a=this.chain.getTokenAddress((r=e.sent).fromCurrency),i=this.chain.getTokenAddress(r.toCurrency),s=this.chain.getTokenAddress(r.feeCurrency),o=Date.now(),["buy","sell"].includes(r.side)){e.next=10;break}throw new Error("Invalid side, should be buy | sell");case 10:if(r.price.gt(0)){e.next=12;break}throw new Error("Invalid price");case 12:if(r.amount.gt(0)){e.next=14;break}throw new Error("Invalid amount");case 14:if(r.priceDeviation.gte(0)){e.next=16;break}throw new Error("Invalid priceDeviation");case 16:if(this.chain.tokensFee[r.feeCurrency]){e.next=18;break}throw new Error("Invalid feeCurrency, should be one of "+Object.keys(this.chain.tokensFee));case 18:if(null!=r.numberFormat.qtyPrecision){e.next=20;break}throw new Error("Invalid qtyPrecision");case 20:if(null!=r.numberFormat.pricePrecision){e.next=22;break}throw new Error("Invalid pricePrecision");case 22:if(!r.chainPrices){e.next=33;break}if(u=r.chainPrices.gasWei,(p={})[this.chain.blockchainInfo.baseCurrencyName]=new n(r.chainPrices.networkAsset),p[r.fromCurrency]=new n(r.chainPrices.baseAsset),p[r.feeCurrency]=new n(r.chainPrices.feeAsset),(c=p)[this.chain.blockchainInfo.baseCurrencyName].gt(0)){e.next=27;break}throw new Error("Invalid chainPrices networkAsset");case 27:if(c[r.fromCurrency].gt(0)){e.next=29;break}throw new Error("Invalid chainPrices baseAsset");case 29:if(c[r.feeCurrency].gt(0)){e.next=31;break}throw new Error("Invalid chainPrices feeAsset");case 31:e.next=39;break;case 33:return e.next=35,this.chain.getGasPrice();case 35:return u=e.sent,e.next=38,this.chain.getBlockchainPrices();case 38:c=e.sent;case 39:if(d=L({baseAsset:r.fromCurrency,amount:r.amount,feePercent:this.chain.tokensFee[r.feeCurrency],assetsPrices:c,networkAsset:this.chain.blockchainInfo.baseCurrencyName,gasPriceWei:u,needWithdraw:r.needWithdraw,isPool:!1,feeAsset:r.feeCurrency,limits:this.chain.baseLimits}),l=r.priceDeviation.isZero()?r.price:C(r.price,r.side,r.priceDeviation),y=r.amount.decimalPlaces(r.numberFormat.qtyPrecision,n.ROUND_DOWN),h=l.decimalPlaces(r.numberFormat.pricePrecision,"buy"===r.side?n.ROUND_UP:n.ROUND_DOWN),!d.isZero()){e.next=45;break}throw new Error("Zero fee");case 45:return e.next=47,this.checkBalanceForOrder(r,r.feeCurrency,d);case 47:return(f={id:"",senderAddress:this.chain.signer.address,matcherAddress:this.chain.blockchainInfo.matcherAddress,baseAsset:a,quoteAsset:i,matcherFeeAsset:s,amount:q(y),price:q(h),matcherFee:q(d),nonce:o,expiration:o+25056e5,buySide:"buy"===r.side?1:0,isPersonalSign:!1,signature:"",needWithdraw:r.needWithdraw}).id=ie(f),e.next=51,re(f,this.chain.signer,this.chain.network.CHAIN_ID);case 51:return f.signature=e.sent,e.next=54,this.exchange.validateOrder(f);case 54:if(e.sent){e.next=56;break}throw new Error("Order validation failed");case 56:return e.abrupt("return",f);case 59:return e.prev=59,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 62:case"end":return e.stop()}}),e,this,[[0,59]])})));return function(t){return e.apply(this,arguments)}}(),t.sendOrder=function(){var e=c(w.mark((function e(t,n){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=!1),e.abrupt("return",H(this.chain.api.orionAggregator.post(n?"/order/internal":"/order",t)));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.cancelOrder=function(){var e=c(w.mark((function e(t){var n;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getOrderById(t);case 3:return n=this.getCancelationSubject(e.sent),e.next=7,te(n,this.chain.signer,this.chain.network.CHAIN_ID);case 7:return n.signature=e.sent,e.abrupt("return",H(this.chain.api.orionAggregator.delete("/order",{data:n})));case 11:return e.prev=11,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),t.getCancelationSubject=function(e){var t=e.blockchainOrder;return{id:e.id,sender:t.senderAddress,signature:"",isPersonalSign:t.isPersonalSign}},t.getTradeHistory=function(){var e=c(w.mark((function e(t){var n,r;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p({address:this.chain.signer.address},t),e.next=4,H(this.chain.api.orionAggregator.get("/order/history",{params:n}));case 4:return r=e.sent,e.abrupt("return",Array.isArray(r)&&r.length?r.map(R):[]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.getOrderById=function(){var e=c(w.mark((function e(t,n){var r;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=this.chain.signer.address),r="/order?orderId="+t+"&owner="+n,e.next=4,H(this.chain.api.orionAggregator.get(r));case 4:return e.abrupt("return",R(e.sent.order));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.getApiVersion=function(){var e=c(w.mark((function e(){var t;return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=1,e.prev=1,e.next=4,H(this.chain.api.orionAggregator.get("/version"));case 4:t=Number(e.sent.apiVersion),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t=1;case 12:return e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),e}(),ue=function(e){function t(t){var n;return(n=e.call(this)||this).socket=t,n}return d(t,e),t.prototype.close=function(){this.socket.close()},t}(o),ce=function(){function e(e){void 0===e&&(e=x.MAIN.BSC),this.wsOrionUrl=e}var t=e.prototype;return t.init=function(){var e=c(w.mark((function e(){return w.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.warn("WS.init() method is currently deprecated and unnecessary"),e.abrupt("return",new Promise((function(e){return e(!0)})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),t.connect=function(e,t,n){var r=new s(e,[],{WebSocket:i}),a=new ue(r);return r.onerror=function(e){throw new Error("WS connection error: "+e.message+"!")},r.onmessage=function(e){if(e.data){var i=JSON.parse(e.data);i&&"pp"===i.T?r.send(JSON.stringify(i)):n&&i.T&&n.T!==i.T+"s"||(t&&(i=t(i)),a.emit("message",i))}},n&&r.send(JSON.stringify(n)),a},t.priceFeedAll=function(){return this.connect(this.wsOrionUrl+"/ws2/allTickers",W)},t.priceFeedTicker=function(e){return this.connect(this.wsOrionUrl+"/ws2/ticker/"+e,W)},t.orderBooks=function(e){return this.orderBooksV2(e)},t.orderBooksV2=function(e){return this.connect(this.wsOrionUrl+"/v1",F,{S:e,T:"aobus"})},e}(),pe={name:"ETH-BTC",minQty:0,maxQty:Number.MAX_VALUE,minPrice:0,maxPrice:Number.MAX_VALUE,pricePrecision:8,qtyPrecision:8,baseAssetPrecision:8,quoteAssetPrecision:8,limitOrderThreshold:.001,executableOnBrokersPriceDeviation:.001};!function(e){e.BUY="buy",e.SELL="sell"}(se||(se={}));var de={__proto__:null,DEFAULT_NUMBER_FORMAT:pe,get Side(){return se}};exports.Chain=Z,exports.Constants=I,exports.Exchange=$,exports.Helpers=z,exports.Models=de,exports.OrionAggregator=oe,exports.Tokens=g,exports.WS=ce;
//# sourceMappingURL=orion-trading-sdk.cjs.production.min.js.map
